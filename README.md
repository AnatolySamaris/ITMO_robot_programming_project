## Проект: управление мобильным роботом при помощи жестов

**Цель**: Реализация управления жестами (Mediapipe + MLP) на примере модели мобильного робота в симуляторе MuJoCo. Управление движением робота осуществляется подачей сигналов заданной скорости на левое и правое колеса робота.

**Технологии**: Python, OpenCV, PyTorch, MediaPipe, MuJoCo.

## Установка и запуск

Клонировать репозиторий в рабочую директорию:
```
git clone https://github.com/AnatolySamaris/ITMO_robot_programming_project
```

Создать и активировать виртуальное окружение Python:
```
python3 -m venv venv
source venv/bin/activate
```

Установить необходимые зависимости:
```
pip install -r requirements.txt
```

Запуск основного скрипта:
```
python3 src/main.py
```

## Добавление своих жестов

1. Запустить скрипт для сбора данных о новом жесте, указав имя жеста с флагом --gesture:
```
python3 src/gesture_recognition/train/make_data.py --gesture GESTURE_NAME
```

В открывшемся окне нажать Space для начала сбора данных.

> Рекомендуется собрать не менее 500 примеров нового жеста в различных позах.

> Демонстрируйте жест при помощи обеих рук для лучшего результата.

По завершении повторно нажать Space и закрыть скрипт. Данные автоматически сохранятся в `src/gesture_recognition/train/dataset/GESTURE_NAME.csv`.

2. Обучить классификатор для распознавания новых жестов. Запустить скрипт обучения классификатора:
```
python3 src/gesture_recognition/train/model_fit.py
```

После успешного завершения обучения классификатора в `src/gesture_recognition` появятся новые файлы `gesture_classifier.pt` (обученный классификатор) и `gesture_mapping.json` (позволит восстановить жест из внутреннего id классификатора в имя жеста).

3. Обновить команды для новых жестов.
Файл `src/main.py` содержит константную переменную `GESTURE_TO_COMMAND`, которую необходимо обновить при обновлении классификатора. Учитывайте индексацию жестов внутри классификатора при обновлении маппинга.

## Примеры работы

Модель робота в MuJoCo. Красный квадрат показывает направление "вперед".

![robot_model](/images/robot_model.png)

Интерфейс управления жестами. Жест "thumbs_up".

![gesture_control_interface](/images/gesture_control_interface.png)
